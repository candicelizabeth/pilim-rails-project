<h1><%= @list.title %></h1>
<p><%= @list.description %></p>
<p>Creator: @<%= link_to @list.user.username, user_path(@list.user) %></p>

<% if @list.user == current_user %>
    <%= link_to "Edit", edit_list_path(@list) %> 
    <%= form_tag list_path(@list), method: :delete do %>
        <%= submit_tag "Delete" %>
    <% end %>
    <br>

    <%= form_tag list_path(@list), method: :get do %>
        <%= search_field_tag :search, nil, placeholder: "Search for a movie to add to list" %>
        <%= submit_tag "Search", name: nil %>
    <% end %>

    <br>

    <% if params[:search] %>
        <% @movies.each do |movie| %>
            <%= movie.title %> (<%= movie.year %>)<br>
            <%= button_to "Add", list_movie_add_path(list_id: @list.id, movie_id: movie.id)  %><br>
        <% end %>
        <% if flash[:message] %>
            <%= render "application/flash_messages" %>
        <% else %>
            <small>If you can't find the movie you're looking for, it's not in our database yet. <%= link_to "Click here to add it!", new_movie_path %></small><br><br>
        <% end %>
    <% end %>
<% end %>

<ul>
    <% @list.movies.each do |movie| %>
        <li><%= link_to movie.title, movie_path(movie) %></li>
        <% if @list.user == current_user %>
            <%= button_to "Delete", list_movie_delete_path(list_id: @list.id, movie_id: movie.id), method: :delete %>
        <% end %>
    <% end %>
</ul>
